
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="utf-8">
            <title>OpenManus Multi-Agent Visualization</title>
            <script src="https://d3js.org/d3.v7.min.js"></script>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    margin: 0;
                    padding: 0;
                }
                #visualization {
                    width: 100%;
                    height: 100vh;
                }
                .node circle {
                    fill: #fff;
                    stroke: steelblue;
                    stroke-width: 2px;
                }
                .node text {
                    font: 12px sans-serif;
                }
                .link {
                    fill: none;
                    stroke: #ccc;
                    stroke-width: 1.5px;
                }
                .tooltip {
                    position: absolute;
                    background-color: rgba(0, 0, 0, 0.8);
                    color: white;
                    padding: 10px;
                    border-radius: 5px;
                    pointer-events: none;
                    max-width: 300px;
                }
                .planning { color: #4CAF50; }
                .swe { color: #2196F3; }
                .browser { color: #FF9800; }
                .terminal { color: #9C27B0; }
                .orchestrator { color: #F44336; }
                .node-planning circle { stroke: #4CAF50; }
                .node-swe circle { stroke: #2196F3; }
                .node-browser circle { stroke: #FF9800; }
                .node-terminal circle { stroke: #9C27B0; }
                .node-orchestrator circle { stroke: #F44336; }
            </style>
        </head>
        <body>
            <div id="visualization"></div>
            <script>
                // The visualization data
                const data = {"taskId":"task_1742918690476_7861","timestamp":1742918739657,"events":[{"id":"task_1742918690476_7861_1742918690514_0","type":"system_message","agent":"orchestrator","state":"running","message":"Orchestrator determined request requires planning","timestamp":1742918690514,"details":{"needsPlanning":true},"children":[]},{"id":"task_1742918690476_7861_1742918690514_1","type":"system_message","agent":"orchestrator","state":"running","message":"Orchestrator determined this request requires planning","timestamp":1742918690514,"details":{"needsPlanning":true,"phase":"planning"},"children":[]},{"id":"task_1742918690476_7861_1742918690515_2","type":"agent_transition","agent":"planning","state":"idle","message":"Transitioning to planning agent: Creating structured plan for the task","timestamp":1742918690515,"details":{"reason":"Creating structured plan for the task"},"children":[]},{"id":"task_1742918690476_7861_1742918702350_3","type":"agent_transition","agent":"orchestrator","state":"idle","message":"Returning to orchestrator after planning completed its task","timestamp":1742918702350,"details":{"previousAgent":"planning"},"children":[]},{"id":"task_1742918690476_7861_1742918708000_4","type":"system_message","agent":"planning","state":"running","message":"Created structured plan: 3-Day Trip Planning","timestamp":1742918708000,"details":{"plan":{"id":"plan_1742918708000_1872","title":"3-Day Trip Planning","description":"This plan will organize a 3-day trip by selecting a destination, booking accommodations, planning transportation, identifying activities, and creating a daily itinerary.","createdAt":1742918708000,"updatedAt":1742918708000,"steps":[{"id":"step_1_1742918708000","description":"Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","assignedAgent":"planning","completed":true,"result":"To determine the destination for the trip, I need to gather information about the user's preferences regarding the type of destination they are interested in (e.g., beach, city, mountains). This will guide the selection process and ensure the destination aligns with the user's interests. Here's how I will approach this task:\n\n1. **Gather User Preferences**: Understand the user's preferences for the type of destination they are interested in.\n2. **Research Potential Destinations**: Based on the preferences, research potential destinations that fit the criteria.\n3. **Select the Destination**: Choose the most suitable destination based on the research and user preferences.\n\nHere's the detailed plan for this step:\n\nPLAN TITLE: Determine Trip Destination\n\nPLAN DESCRIPTION: This plan will identify a suitable destination for the 3-day trip based on user preferences.\n\nSTEPS:\n1. [PLANNING] Gather information about the user's preferences for the type of destination (e.g., beach, city, mountains).\n   DEPENDS_ON: None\n\n2. [BROWSER] Research potential destinations that fit the user's preferences.\n   DEPENDS_ON: 1\n\n3. [PLANNING] Select the most suitable destination based on the research and user preferences.\n   DEPENDS_ON: 2\n\nThis plan will ensure that the destination is chosen based on the user's interests, leading to a more enjoyable trip experience.","completedAt":1742918713586},{"id":"step_2_1742918708000","description":"Research and list accommodation options at the chosen destination, considering budget and preferences.","assignedAgent":"browser","completed":true,"dependsOn":["step_1_1742918708000"],"result":"\nObserved output of cmd `browser` executed:\nSearched for 'best accommodations in [Destination] for a 3-day trip' and navigated to first result:\nhttps://www.trawell.in/itineraries/chennai/3-day-trip\n\nTitle: 45 Best 3 Days Trips near Chennai\n\nContent Summary:\nHEADINGS:\n45 Best 3 Days Trips near Chennai\nTour Packages near Chennai\nTop Getaways near Chennai\nTrips from Chennai\nSimilar 3 Days Trips\nOur WhatsApp Numbers\nRequest Quote\nContact Us\nNeed Customized Tour? Request Quote\n[content truncated...]","completedAt":1742918722673},{"id":"step_3_1742918708000","description":"Find transportation options to the destination (e.g., flights, trains, buses) and local transportation (e.g., car rentals, public transit).","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_4_1742918708000","description":"Identify key activities and attractions at the destination, including any special events during the travel dates.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_5_1742918708000","description":"Research dining options, including restaurants and cafes, that cater to dietary preferences.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_6_1742918708000","description":"Create a detailed itinerary for each day of the trip, including activities, dining, and transportation.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742918708000","step_3_1742918708000","step_4_1742918708000","step_5_1742918708000"]}],"completion":0}},"children":[]},{"id":"task_1742918690476_7861_1742918708002_5","type":"system_message","agent":"orchestrator","state":"running","message":"Orchestrator beginning plan execution phase","timestamp":1742918708002,"details":{"phase":"execution","planId":"plan_1742918708000_1872"},"children":[]},{"id":"task_1742918690476_7861_1742918708002_6","type":"system_message","agent":"orchestrator","state":"running","message":"Beginning execution of plan: 3-Day Trip Planning","timestamp":1742918708002,"details":{"plan":{"id":"plan_1742918708000_1872","title":"3-Day Trip Planning","description":"This plan will organize a 3-day trip by selecting a destination, booking accommodations, planning transportation, identifying activities, and creating a daily itinerary.","createdAt":1742918708000,"updatedAt":1742918708000,"steps":[{"id":"step_1_1742918708000","description":"Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","assignedAgent":"planning","completed":true,"result":"To determine the destination for the trip, I need to gather information about the user's preferences regarding the type of destination they are interested in (e.g., beach, city, mountains). This will guide the selection process and ensure the destination aligns with the user's interests. Here's how I will approach this task:\n\n1. **Gather User Preferences**: Understand the user's preferences for the type of destination they are interested in.\n2. **Research Potential Destinations**: Based on the preferences, research potential destinations that fit the criteria.\n3. **Select the Destination**: Choose the most suitable destination based on the research and user preferences.\n\nHere's the detailed plan for this step:\n\nPLAN TITLE: Determine Trip Destination\n\nPLAN DESCRIPTION: This plan will identify a suitable destination for the 3-day trip based on user preferences.\n\nSTEPS:\n1. [PLANNING] Gather information about the user's preferences for the type of destination (e.g., beach, city, mountains).\n   DEPENDS_ON: None\n\n2. [BROWSER] Research potential destinations that fit the user's preferences.\n   DEPENDS_ON: 1\n\n3. [PLANNING] Select the most suitable destination based on the research and user preferences.\n   DEPENDS_ON: 2\n\nThis plan will ensure that the destination is chosen based on the user's interests, leading to a more enjoyable trip experience.","completedAt":1742918713586},{"id":"step_2_1742918708000","description":"Research and list accommodation options at the chosen destination, considering budget and preferences.","assignedAgent":"browser","completed":true,"dependsOn":["step_1_1742918708000"],"result":"\nObserved output of cmd `browser` executed:\nSearched for 'best accommodations in [Destination] for a 3-day trip' and navigated to first result:\nhttps://www.trawell.in/itineraries/chennai/3-day-trip\n\nTitle: 45 Best 3 Days Trips near Chennai\n\nContent Summary:\nHEADINGS:\n45 Best 3 Days Trips near Chennai\nTour Packages near Chennai\nTop Getaways near Chennai\nTrips from Chennai\nSimilar 3 Days Trips\nOur WhatsApp Numbers\nRequest Quote\nContact Us\nNeed Customized Tour? Request Quote\n[content truncated...]","completedAt":1742918722673},{"id":"step_3_1742918708000","description":"Find transportation options to the destination (e.g., flights, trains, buses) and local transportation (e.g., car rentals, public transit).","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_4_1742918708000","description":"Identify key activities and attractions at the destination, including any special events during the travel dates.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_5_1742918708000","description":"Research dining options, including restaurants and cafes, that cater to dietary preferences.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_6_1742918708000","description":"Create a detailed itinerary for each day of the trip, including activities, dining, and transportation.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742918708000","step_3_1742918708000","step_4_1742918708000","step_5_1742918708000"]}],"completion":0}},"children":[]},{"id":"task_1742918690476_7861_1742918708003_7","type":"agent_selection","agent":"orchestrator","state":"running","message":"Orchestrator selecting planning to execute: Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","timestamp":1742918708003,"details":{"step":{"id":"step_1_1742918708000","description":"Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","assignedAgent":"planning","completed":true,"result":"To determine the destination for the trip, I need to gather information about the user's preferences regarding the type of destination they are interested in (e.g., beach, city, mountains). This will guide the selection process and ensure the destination aligns with the user's interests. Here's how I will approach this task:\n\n1. **Gather User Preferences**: Understand the user's preferences for the type of destination they are interested in.\n2. **Research Potential Destinations**: Based on the preferences, research potential destinations that fit the criteria.\n3. **Select the Destination**: Choose the most suitable destination based on the research and user preferences.\n\nHere's the detailed plan for this step:\n\nPLAN TITLE: Determine Trip Destination\n\nPLAN DESCRIPTION: This plan will identify a suitable destination for the 3-day trip based on user preferences.\n\nSTEPS:\n1. [PLANNING] Gather information about the user's preferences for the type of destination (e.g., beach, city, mountains).\n   DEPENDS_ON: None\n\n2. [BROWSER] Research potential destinations that fit the user's preferences.\n   DEPENDS_ON: 1\n\n3. [PLANNING] Select the most suitable destination based on the research and user preferences.\n   DEPENDS_ON: 2\n\nThis plan will ensure that the destination is chosen based on the user's interests, leading to a more enjoyable trip experience.","completedAt":1742918713586},"agent":"planning","orchestratorDecision":true},"children":[{"id":"task_1742918690476_7861_1742918713585_10","type":"agent_transition","agent":"orchestrator","state":"running","message":"Orchestrator received results from planning for step: Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","timestamp":1742918713585,"details":{"step":{"id":"step_1_1742918708000","description":"Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","assignedAgent":"planning","completed":true,"result":"To determine the destination for the trip, I need to gather information about the user's preferences regarding the type of destination they are interested in (e.g., beach, city, mountains). This will guide the selection process and ensure the destination aligns with the user's interests. Here's how I will approach this task:\n\n1. **Gather User Preferences**: Understand the user's preferences for the type of destination they are interested in.\n2. **Research Potential Destinations**: Based on the preferences, research potential destinations that fit the criteria.\n3. **Select the Destination**: Choose the most suitable destination based on the research and user preferences.\n\nHere's the detailed plan for this step:\n\nPLAN TITLE: Determine Trip Destination\n\nPLAN DESCRIPTION: This plan will identify a suitable destination for the 3-day trip based on user preferences.\n\nSTEPS:\n1. [PLANNING] Gather information about the user's preferences for the type of destination (e.g., beach, city, mountains).\n   DEPENDS_ON: None\n\n2. [BROWSER] Research potential destinations that fit the user's preferences.\n   DEPENDS_ON: 1\n\n3. [PLANNING] Select the most suitable destination based on the research and user preferences.\n   DEPENDS_ON: 2\n\nThis plan will ensure that the destination is chosen based on the user's interests, leading to a more enjoyable trip experience.","completedAt":1742918713586},"result":"To determine the destination for the trip, I need to gather information about the user's preferences regarding the type of destination they are interested in (e.g., beach, city, mountains). This will ","returnToOrchestrator":true},"children":[]}]},{"id":"task_1742918690476_7861_1742918708004_8","type":"agent_transition","agent":"planning","state":"idle","message":"Transitioning to planning agent: Executing plan step: Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","timestamp":1742918708004,"details":{"reason":"Executing plan step: Determine the destination for the trip based on user preferences (e.g., beach, city, mountains)."},"children":[]},{"id":"task_1742918690476_7861_1742918713583_9","type":"agent_transition","agent":"orchestrator","state":"idle","message":"Returning to orchestrator after planning completed its task","timestamp":1742918713583,"details":{"previousAgent":"planning"},"children":[]},{"id":"task_1742918690476_7861_1742918713586_11","type":"agent_selection","agent":"orchestrator","state":"running","message":"Orchestrator selecting browser to execute: Research and list accommodation options at the chosen destination, considering budget and preferences.","timestamp":1742918713586,"details":{"step":{"id":"step_2_1742918708000","description":"Research and list accommodation options at the chosen destination, considering budget and preferences.","assignedAgent":"browser","completed":true,"dependsOn":["step_1_1742918708000"],"result":"\nObserved output of cmd `browser` executed:\nSearched for 'best accommodations in [Destination] for a 3-day trip' and navigated to first result:\nhttps://www.trawell.in/itineraries/chennai/3-day-trip\n\nTitle: 45 Best 3 Days Trips near Chennai\n\nContent Summary:\nHEADINGS:\n45 Best 3 Days Trips near Chennai\nTour Packages near Chennai\nTop Getaways near Chennai\nTrips from Chennai\nSimilar 3 Days Trips\nOur WhatsApp Numbers\nRequest Quote\nContact Us\nNeed Customized Tour? Request Quote\n[content truncated...]","completedAt":1742918722673},"agent":"browser","orchestratorDecision":true},"children":[{"id":"task_1742918690476_7861_1742918722672_14","type":"agent_transition","agent":"orchestrator","state":"running","message":"Orchestrator received results from browser for step: Research and list accommodation options at the chosen destination, considering budget and preferences.","timestamp":1742918722672,"details":{"step":{"id":"step_2_1742918708000","description":"Research and list accommodation options at the chosen destination, considering budget and preferences.","assignedAgent":"browser","completed":true,"dependsOn":["step_1_1742918708000"],"result":"\nObserved output of cmd `browser` executed:\nSearched for 'best accommodations in [Destination] for a 3-day trip' and navigated to first result:\nhttps://www.trawell.in/itineraries/chennai/3-day-trip\n\nTitle: 45 Best 3 Days Trips near Chennai\n\nContent Summary:\nHEADINGS:\n45 Best 3 Days Trips near Chennai\nTour Packages near Chennai\nTop Getaways near Chennai\nTrips from Chennai\nSimilar 3 Days Trips\nOur WhatsApp Numbers\nRequest Quote\nContact Us\nNeed Customized Tour? Request Quote\n[content truncated...]","completedAt":1742918722673},"result":"\nObserved output of cmd `browser` executed:\nSearched for 'best accommodations in [Destination] for a 3-day trip' and navigated to first result:\nhttps://www.trawell.in/itineraries/chennai/3-day-trip\n\nT","returnToOrchestrator":true},"children":[]}]},{"id":"task_1742918690476_7861_1742918713586_12","type":"agent_transition","agent":"browser","state":"idle","message":"Transitioning to browser agent: Executing plan step: Research and list accommodation options at the chosen destination, considering budget and preferences.","timestamp":1742918713586,"details":{"reason":"Executing plan step: Research and list accommodation options at the chosen destination, considering budget and preferences."},"children":[]},{"id":"task_1742918690476_7861_1742918722669_13","type":"agent_transition","agent":"orchestrator","state":"idle","message":"Returning to orchestrator after browser completed its task","timestamp":1742918722669,"details":{"previousAgent":"browser"},"children":[]},{"id":"task_1742918690476_7861_1742918722673_15","type":"agent_transition","agent":"planning","state":"idle","message":"Transitioning to planning agent: Reviewing execution of step: Research and list accommodation options at the chosen destination, considering budget and preferences.","timestamp":1742918722673,"details":{"reason":"Reviewing execution of step: Research and list accommodation options at the chosen destination, considering budget and preferences."},"children":[]},{"id":"task_1742918690476_7861_1742918728932_16","type":"agent_transition","agent":"orchestrator","state":"idle","message":"Returning to orchestrator after planning completed its task","timestamp":1742918728932,"details":{"previousAgent":"planning"},"children":[]},{"id":"task_1742918690476_7861_1742918735438_17","type":"system_message","agent":"planning","state":"running","message":"Step execution review: The execution of the step to research and list accommodation options was not successful. The search was too generic and did not yield specific accommodation options. The result was a list of trips near Chennai, which does not align with the task of finding accommodations. The search query needs to be more specific to the destination and should include parameters like budget and accommodation type.","timestamp":1742918735438,"details":{"feedback":"The execution of the step to research and list accommodation options was not successful. The search was too generic and did not yield specific accommodation options. The result was a list of trips near Chennai, which does not align with the task of finding accommodations. The search query needs to be more specific to the destination and should include parameters like budget and accommodation type."},"children":[]},{"id":"task_1742918690476_7861_1742918735440_18","type":"system_message","agent":"planning","state":"running","message":"Recommended stopping plan execution: The execution of the step to research and list accommodation options was not successful. The search was too generic and did not yield specific accommodation options. The result was a list of trips near Chennai, which does not align with the task of finding accommodations. The search query needs to be more specific to the destination and should include parameters like budget and accommodation type.","timestamp":1742918735440,"details":{"reason":"The execution of the step to research and list accommodation options was not successful. The search was too generic and did not yield specific accommodation options. The result was a list of trips near Chennai, which does not align with the task of finding accommodations. The search query needs to be more specific to the destination and should include parameters like budget and accommodation type."},"children":[]},{"id":"task_1742918690476_7861_1742918735441_19","type":"completion","agent":"orchestrator","state":"running","message":"Plan execution stopped early by planning agent recommendation (33% complete)","timestamp":1742918735441,"details":{"plan":{"id":"plan_1742918708000_1872","title":"3-Day Trip Planning","description":"This plan will organize a 3-day trip by selecting a destination, booking accommodations, planning transportation, identifying activities, and creating a daily itinerary.","createdAt":1742918708000,"updatedAt":1742918722673,"steps":[{"id":"step_1_1742918708000","description":"Determine the destination for the trip based on user preferences (e.g., beach, city, mountains).","assignedAgent":"planning","completed":true,"result":"To determine the destination for the trip, I need to gather information about the user's preferences regarding the type of destination they are interested in (e.g., beach, city, mountains). This will guide the selection process and ensure the destination aligns with the user's interests. Here's how I will approach this task:\n\n1. **Gather User Preferences**: Understand the user's preferences for the type of destination they are interested in.\n2. **Research Potential Destinations**: Based on the preferences, research potential destinations that fit the criteria.\n3. **Select the Destination**: Choose the most suitable destination based on the research and user preferences.\n\nHere's the detailed plan for this step:\n\nPLAN TITLE: Determine Trip Destination\n\nPLAN DESCRIPTION: This plan will identify a suitable destination for the 3-day trip based on user preferences.\n\nSTEPS:\n1. [PLANNING] Gather information about the user's preferences for the type of destination (e.g., beach, city, mountains).\n   DEPENDS_ON: None\n\n2. [BROWSER] Research potential destinations that fit the user's preferences.\n   DEPENDS_ON: 1\n\n3. [PLANNING] Select the most suitable destination based on the research and user preferences.\n   DEPENDS_ON: 2\n\nThis plan will ensure that the destination is chosen based on the user's interests, leading to a more enjoyable trip experience.","completedAt":1742918713586},{"id":"step_2_1742918708000","description":"Research and list accommodation options at the chosen destination, considering budget and preferences.","assignedAgent":"browser","completed":true,"dependsOn":["step_1_1742918708000"],"result":"\nObserved output of cmd `browser` executed:\nSearched for 'best accommodations in [Destination] for a 3-day trip' and navigated to first result:\nhttps://www.trawell.in/itineraries/chennai/3-day-trip\n\nTitle: 45 Best 3 Days Trips near Chennai\n\nContent Summary:\nHEADINGS:\n45 Best 3 Days Trips near Chennai\nTour Packages near Chennai\nTop Getaways near Chennai\nTrips from Chennai\nSimilar 3 Days Trips\nOur WhatsApp Numbers\nRequest Quote\nContact Us\nNeed Customized Tour? Request Quote\n[content truncated...]","completedAt":1742918722673},{"id":"step_3_1742918708000","description":"Find transportation options to the destination (e.g., flights, trains, buses) and local transportation (e.g., car rentals, public transit).","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_4_1742918708000","description":"Identify key activities and attractions at the destination, including any special events during the travel dates.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_5_1742918708000","description":"Research dining options, including restaurants and cafes, that cater to dietary preferences.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742918708000"]},{"id":"step_6_1742918708000","description":"Create a detailed itinerary for each day of the trip, including activities, dining, and transportation.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742918708000","step_3_1742918708000","step_4_1742918708000","step_5_1742918708000"]}],"completion":33},"completionPercentage":33,"earlyCompletion":true},"children":[]},{"id":"task_1742918690476_7861_1742918739650_20","type":"system_message","agent":"orchestrator","state":"running","message":"Orchestrator synthesizing final answer","timestamp":1742918739650,"details":{"request":"Plan a 3-day trip for me","synthesisLength":1164},"children":[]}]};

                // Set up the tree layout
                const margin = {top: 20, right: 120, bottom: 20, left: 120};
                const width = window.innerWidth - margin.right - margin.left;
                const height = window.innerHeight - margin.top - margin.bottom;

                // Create the tree layout
                const tree = d3.tree().size([height, width]);

                // Create tooltip
                const tooltip = d3.select("body").append("div")
                    .attr("class", "tooltip")
                    .style("opacity", 0);

                // Create the SVG
                const svg = d3.select("#visualization").append("svg")
                    .attr("width", width + margin.right + margin.left)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

                // Helper function to get color based on agent type
                function getColor(agent) {
                    switch(agent) {
                        case 'planning': return '#4CAF50';
                        case 'swe': return '#2196F3';
                        case 'browser': return '#FF9800';
                        case 'terminal': return '#9C27B0';
                        case 'orchestrator': return '#F44336';
                        default: return '#9E9E9E';
                    }
                }

                // Convert the data to D3 hierarchy
                const rootData = data.events[0]; // Assuming the first root event is the main one
                const root = d3.hierarchy(rootData);

                // Assign the data to the tree layout
                tree(root);

                // Add links between nodes
                svg.selectAll(".link")
                    .data(root.links())
                    .enter().append("path")
                    .attr("class", "link")
                    .attr("d", d3.linkHorizontal()
                        .x(d => d.y)
                        .y(d => d.x));

                // Add each node
                const node = svg.selectAll(".node")
                    .data(root.descendants())
                    .enter().append("g")
                    .attr("class", d => "node node-" + d.data.agent)
                    .attr("transform", d => "translate(" + d.y + "," + d.x + ")")
                    .on("mouseover", function(event, d) {
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(
                            "<strong>Agent:</strong> " + d.data.agent + "<br/>" +
                            "<strong>Event:</strong> " + d.data.type + "<br/>" +
                            "<strong>Message:</strong> " + d.data.message + "<br/>" +
                            "<strong>Step:</strong> " + (d.data.step || 'N/A') + "<br/>" +
                            "<strong>State:</strong> " + d.data.state
                        )
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function(d) {
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });

                // Add circles to the nodes
                node.append("circle")
                    .attr("r", 8);

                // Add text labels
                node.append("text")
                    .attr("dy", ".35em")
                    .attr("x", d => d.children ? -13 : 13)
                    .style("text-anchor", d => d.children ? "end" : "start")
                    .text(d => {
                        const label = d.data.type.split('_').map(word =>
                            word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
                        ).join(' ');
                        return label;
                    });
            </script>
        </body>
        </html>
        