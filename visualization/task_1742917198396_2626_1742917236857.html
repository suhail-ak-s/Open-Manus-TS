
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="utf-8">
            <title>OpenManus Multi-Agent Visualization</title>
            <script src="https://d3js.org/d3.v7.min.js"></script>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    margin: 0;
                    padding: 0;
                }
                #visualization {
                    width: 100%;
                    height: 100vh;
                }
                .node circle {
                    fill: #fff;
                    stroke: steelblue;
                    stroke-width: 2px;
                }
                .node text {
                    font: 12px sans-serif;
                }
                .link {
                    fill: none;
                    stroke: #ccc;
                    stroke-width: 1.5px;
                }
                .tooltip {
                    position: absolute;
                    background-color: rgba(0, 0, 0, 0.8);
                    color: white;
                    padding: 10px;
                    border-radius: 5px;
                    pointer-events: none;
                    max-width: 300px;
                }
                .planning { color: #4CAF50; }
                .swe { color: #2196F3; }
                .browser { color: #FF9800; }
                .terminal { color: #9C27B0; }
                .orchestrator { color: #F44336; }
                .node-planning circle { stroke: #4CAF50; }
                .node-swe circle { stroke: #2196F3; }
                .node-browser circle { stroke: #FF9800; }
                .node-terminal circle { stroke: #9C27B0; }
                .node-orchestrator circle { stroke: #F44336; }
            </style>
        </head>
        <body>
            <div id="visualization"></div>
            <script>
                // The visualization data
                const data = {"taskId":"task_1742917198396_2626","timestamp":1742917236857,"events":[{"id":"task_1742917198396_2626_1742917198433_0","type":"user_input","agent":"orchestrator","state":"idle","message":"User request: Plan a 3-day trip for me","timestamp":1742917198433,"details":{"request":"Plan a 3-day trip for me"},"children":[]},{"id":"task_1742917198396_2626_1742917198434_1","type":"agent_transition","agent":"planning","state":"idle","message":"Transitioning to planning agent: Creating structured plan for the task","timestamp":1742917198434,"details":{"reason":"Creating structured plan for the task"},"children":[]},{"id":"task_1742917198396_2626_1742917211443_2","type":"agent_transition","agent":"orchestrator","state":"idle","message":"Returning to orchestrator after planning completed its task","timestamp":1742917211443,"details":{"previousAgent":"planning"},"children":[]},{"id":"task_1742917198396_2626_1742917218288_3","type":"system_message","agent":"planning","state":"running","message":"Created structured plan: 3-Day Trip Planning","timestamp":1742917218288,"details":{"plan":{"id":"plan_1742917218287_2599","title":"3-Day Trip Planning","description":"This plan outlines the steps to organize a 3-day trip, including destination selection, accommodation, transportation, activities, dining, budgeting, and packing.","createdAt":1742917218287,"updatedAt":1742917218288,"steps":[{"id":"step_1_1742917218288","description":"Research popular travel destinations for a 3-day trip and select one.","assignedAgent":"browser","completed":true,"result":"\nCmd `browser` completed with no output","completedAt":1742917222280},{"id":"step_2_1742917218288","description":"Find and select accommodation options at the chosen destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_3_1742917218288","description":"Plan transportation to the destination, including flights, trains, or car rentals.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_4_1742917218288","description":"Identify and list popular activities and attractions at the destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_5_1742917218288","description":"Research dining options, including popular restaurants and local cuisine.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_6_1742917218288","description":"Check the weather forecast for the destination during the trip dates.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_7_1742917218288","description":"Create a daily itinerary combining accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917218288","step_3_1742917218288","step_4_1742917218288","step_5_1742917218288"]},{"id":"step_8_1742917218288","description":"Estimate the budget for the trip, including accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917218288","step_3_1742917218288","step_4_1742917218288","step_5_1742917218288"]},{"id":"step_9_1742917218288","description":"Suggest a packing list based on the weather forecast and planned activities.","assignedAgent":"planning","completed":false,"dependsOn":["step_6_1742917218288"]}],"completion":0}},"children":[]},{"id":"task_1742917198396_2626_1742917218291_4","type":"system_message","agent":"orchestrator","state":"running","message":"Beginning execution of plan: 3-Day Trip Planning","timestamp":1742917218291,"details":{"plan":{"id":"plan_1742917218287_2599","title":"3-Day Trip Planning","description":"This plan outlines the steps to organize a 3-day trip, including destination selection, accommodation, transportation, activities, dining, budgeting, and packing.","createdAt":1742917218287,"updatedAt":1742917218288,"steps":[{"id":"step_1_1742917218288","description":"Research popular travel destinations for a 3-day trip and select one.","assignedAgent":"browser","completed":true,"result":"\nCmd `browser` completed with no output","completedAt":1742917222280},{"id":"step_2_1742917218288","description":"Find and select accommodation options at the chosen destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_3_1742917218288","description":"Plan transportation to the destination, including flights, trains, or car rentals.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_4_1742917218288","description":"Identify and list popular activities and attractions at the destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_5_1742917218288","description":"Research dining options, including popular restaurants and local cuisine.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_6_1742917218288","description":"Check the weather forecast for the destination during the trip dates.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917218288"]},{"id":"step_7_1742917218288","description":"Create a daily itinerary combining accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917218288","step_3_1742917218288","step_4_1742917218288","step_5_1742917218288"]},{"id":"step_8_1742917218288","description":"Estimate the budget for the trip, including accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917218288","step_3_1742917218288","step_4_1742917218288","step_5_1742917218288"]},{"id":"step_9_1742917218288","description":"Suggest a packing list based on the weather forecast and planned activities.","assignedAgent":"planning","completed":false,"dependsOn":["step_6_1742917218288"]}],"completion":0}},"children":[]},{"id":"task_1742917198396_2626_1742917218292_5","type":"agent_selection","agent":"orchestrator","state":"running","message":"Orchestrator selecting browser to execute: Research popular travel destinations for a 3-day trip and select one.","timestamp":1742917218292,"details":{"step":{"id":"step_1_1742917218288","description":"Research popular travel destinations for a 3-day trip and select one.","assignedAgent":"browser","completed":true,"result":"\nCmd `browser` completed with no output","completedAt":1742917222280},"agent":"browser","orchestratorDecision":true},"children":[{"id":"task_1742917198396_2626_1742917222278_8","type":"agent_transition","agent":"orchestrator","state":"running","message":"Orchestrator received results from browser for step: Research popular travel destinations for a 3-day trip and select one.","timestamp":1742917222278,"details":{"step":{"id":"step_1_1742917218288","description":"Research popular travel destinations for a 3-day trip and select one.","assignedAgent":"browser","completed":true,"result":"\nCmd `browser` completed with no output","completedAt":1742917222280},"result":"\nCmd `browser` completed with no output","returnToOrchestrator":true},"children":[]}]},{"id":"task_1742917198396_2626_1742917218293_6","type":"agent_transition","agent":"browser","state":"idle","message":"Transitioning to browser agent: Executing plan step: Research popular travel destinations for a 3-day trip and select one.","timestamp":1742917218293,"details":{"reason":"Executing plan step: Research popular travel destinations for a 3-day trip and select one."},"children":[]},{"id":"task_1742917198396_2626_1742917222277_7","type":"agent_transition","agent":"orchestrator","state":"idle","message":"Returning to orchestrator after browser completed its task","timestamp":1742917222277,"details":{"previousAgent":"browser"},"children":[]},{"id":"task_1742917198396_2626_1742917222280_9","type":"agent_transition","agent":"planning","state":"idle","message":"Transitioning to planning agent: Reviewing execution of step: Research popular travel destinations for a 3-day trip and select one.","timestamp":1742917222280,"details":{"reason":"Reviewing execution of step: Research popular travel destinations for a 3-day trip and select one."},"children":[]},{"id":"task_1742917198396_2626_1742917227163_10","type":"agent_transition","agent":"orchestrator","state":"idle","message":"Returning to orchestrator after planning completed its task","timestamp":1742917227163,"details":{"previousAgent":"planning"},"children":[]},{"id":"task_1742917198396_2626_1742917236849_11","type":"system_message","agent":"planning","state":"running","message":"Updated plan after step execution: No specific feedback provided.","timestamp":1742917236849,"details":{"plan":{"id":"plan_1742917236849_8456","title":"3-Day Trip Planning","description":"This plan outlines the steps to organize a 3-day trip, including destination selection, accommodation, transportation, activities, dining, budgeting, and packing.","createdAt":1742917236849,"updatedAt":1742917236849,"steps":[{"id":"step_1_1742917236849","description":"Perform a web search for popular travel destinations for a 3-day trip and select one based on user preferences or popular recommendations.","assignedAgent":"browser","completed":false},{"id":"step_2_1742917236849","description":"Find and select accommodation options at the chosen destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_3_1742917236849","description":"Plan transportation to the destination, including flights, trains, or car rentals.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_4_1742917236849","description":"Identify and list popular activities and attractions at the destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_5_1742917236849","description":"Research dining options, including popular restaurants and local cuisine.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_6_1742917236849","description":"Check the weather forecast for the destination during the trip dates.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_7_1742917236849","description":"Create a daily itinerary combining accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917236849","step_3_1742917236849","step_4_1742917236849","step_5_1742917236849"]},{"id":"step_8_1742917236849","description":"Estimate the budget for the trip, including accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917236849","step_3_1742917236849","step_4_1742917236849","step_5_1742917236849"]},{"id":"step_9_1742917236849","description":"Suggest a packing list based on the weather forecast and planned activities.","assignedAgent":"planning","completed":false,"dependsOn":["step_6_1742917236849"]}],"completion":0},"feedback":"No specific feedback provided."},"children":[]},{"id":"task_1742917198396_2626_1742917236851_12","type":"system_message","agent":"planning","state":"running","message":"Recommended stopping plan execution: No specific feedback provided.","timestamp":1742917236851,"details":{"reason":"No specific feedback provided."},"children":[]},{"id":"task_1742917198396_2626_1742917236853_13","type":"completion","agent":"orchestrator","state":"running","message":"Plan execution stopped early by planning agent recommendation (0% complete)","timestamp":1742917236853,"details":{"plan":{"id":"plan_1742917236849_8456","title":"3-Day Trip Planning","description":"This plan outlines the steps to organize a 3-day trip, including destination selection, accommodation, transportation, activities, dining, budgeting, and packing.","createdAt":1742917236849,"updatedAt":1742917236849,"steps":[{"id":"step_1_1742917236849","description":"Perform a web search for popular travel destinations for a 3-day trip and select one based on user preferences or popular recommendations.","assignedAgent":"browser","completed":false},{"id":"step_2_1742917236849","description":"Find and select accommodation options at the chosen destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_3_1742917236849","description":"Plan transportation to the destination, including flights, trains, or car rentals.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_4_1742917236849","description":"Identify and list popular activities and attractions at the destination.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_5_1742917236849","description":"Research dining options, including popular restaurants and local cuisine.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_6_1742917236849","description":"Check the weather forecast for the destination during the trip dates.","assignedAgent":"browser","completed":false,"dependsOn":["step_1_1742917236849"]},{"id":"step_7_1742917236849","description":"Create a daily itinerary combining accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917236849","step_3_1742917236849","step_4_1742917236849","step_5_1742917236849"]},{"id":"step_8_1742917236849","description":"Estimate the budget for the trip, including accommodation, transportation, activities, and dining.","assignedAgent":"planning","completed":false,"dependsOn":["step_2_1742917236849","step_3_1742917236849","step_4_1742917236849","step_5_1742917236849"]},{"id":"step_9_1742917236849","description":"Suggest a packing list based on the weather forecast and planned activities.","assignedAgent":"planning","completed":false,"dependsOn":["step_6_1742917236849"]}],"completion":0},"completionPercentage":0,"earlyCompletion":true},"children":[]}]};

                // Set up the tree layout
                const margin = {top: 20, right: 120, bottom: 20, left: 120};
                const width = window.innerWidth - margin.right - margin.left;
                const height = window.innerHeight - margin.top - margin.bottom;

                // Create the tree layout
                const tree = d3.tree().size([height, width]);

                // Create tooltip
                const tooltip = d3.select("body").append("div")
                    .attr("class", "tooltip")
                    .style("opacity", 0);

                // Create the SVG
                const svg = d3.select("#visualization").append("svg")
                    .attr("width", width + margin.right + margin.left)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

                // Helper function to get color based on agent type
                function getColor(agent) {
                    switch(agent) {
                        case 'planning': return '#4CAF50';
                        case 'swe': return '#2196F3';
                        case 'browser': return '#FF9800';
                        case 'terminal': return '#9C27B0';
                        case 'orchestrator': return '#F44336';
                        default: return '#9E9E9E';
                    }
                }

                // Convert the data to D3 hierarchy
                const rootData = data.events[0]; // Assuming the first root event is the main one
                const root = d3.hierarchy(rootData);

                // Assign the data to the tree layout
                tree(root);

                // Add links between nodes
                svg.selectAll(".link")
                    .data(root.links())
                    .enter().append("path")
                    .attr("class", "link")
                    .attr("d", d3.linkHorizontal()
                        .x(d => d.y)
                        .y(d => d.x));

                // Add each node
                const node = svg.selectAll(".node")
                    .data(root.descendants())
                    .enter().append("g")
                    .attr("class", d => "node node-" + d.data.agent)
                    .attr("transform", d => "translate(" + d.y + "," + d.x + ")")
                    .on("mouseover", function(event, d) {
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(
                            "<strong>Agent:</strong> " + d.data.agent + "<br/>" +
                            "<strong>Event:</strong> " + d.data.type + "<br/>" +
                            "<strong>Message:</strong> " + d.data.message + "<br/>" +
                            "<strong>Step:</strong> " + (d.data.step || 'N/A') + "<br/>" +
                            "<strong>State:</strong> " + d.data.state
                        )
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function(d) {
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });

                // Add circles to the nodes
                node.append("circle")
                    .attr("r", 8);

                // Add text labels
                node.append("text")
                    .attr("dy", ".35em")
                    .attr("x", d => d.children ? -13 : 13)
                    .style("text-anchor", d => d.children ? "end" : "start")
                    .text(d => {
                        const label = d.data.type.split('_').map(word =>
                            word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
                        ).join(' ');
                        return label;
                    });
            </script>
        </body>
        </html>
        